# Contact Form Setup Guide

## Overview

The contact form uses a Next.js API route that:
- Sends emails via **Resend** (free tier: 3,000 emails/month)
- Stores all submissions in `data/submissions.json` (JSON format)
- Can export submissions to CSV using the provided script

## Setup Steps

### 1. Create Resend Account

1. Go to [resend.com](https://resend.com)
2. Sign up for a free account
3. Verify your email

### 2. Get API Key

1. Go to [Resend Dashboard](https://resend.com/api-keys)
2. Click "Create API Key"
3. Name it (e.g., "Apigen Contact Form")
4. Copy the API key (starts with `re_`)

### 3. Verify Domain (Optional - Can Do Later)

**For now:** You can use Resend's test domain `onboarding@resend.dev` - no DNS setup needed!

**For production later:** When ready, verify your domain:
1. Go to [Resend Domains](https://resend.com/domains)
2. Add your domain (e.g., `apigen.ca`)
3. Add the DNS records they provide
4. Wait for verification
5. Update `RESEND_FROM_EMAIL` environment variable

**Note:** The test domain works fine for now - emails will send successfully. Domain verification is just for using your own domain in the "from" address.

### 4. Set Environment Variables

Add these to your production environment (Vercel, etc.):

```env
# Resend API Key (required)
RESEND_API_KEY=re_your_api_key_here

# Contact email recipient (optional, defaults to sunny@apigen.ca)
CONTACT_EMAIL=sunny@apigen.ca
```

**For local development**, add to `.env.local`:
```env
RESEND_API_KEY=re_your_api_key_here
CONTACT_EMAIL=sunny@apigen.ca
```

### 5. Update From Email in API Route

In `src/app/api/contact/route.ts`, update the `from` field:

```typescript
from: "Apigen Contact Form <noreply@apigen.ca>", // Use your verified domain
```

If you haven't verified a domain yet, you can use:
```typescript
from: "onboarding@resend.dev", // Resend's test domain (limited)
```

## How It Works

1. **Form Submission**: User submits contact form
2. **API Route** (`/api/contact`):
   - Validates the data
   - Saves to `data/submissions.json` (includes timestamp and ID)
   - Sends email via Resend API
   - Returns success/error response
3. **Success Animation**: Shows the premium "Seed to Harvest" animation
4. **Data Storage**: All submissions saved locally in JSON format

## Exporting Submissions to CSV

Run the export script:

```bash
# Export to default location (data/submissions-export.csv)
npx tsx scripts/export-submissions.ts

# Export to custom location
npx tsx scripts/export-submissions.ts /path/to/output.csv
```

The CSV will include:
- ID
- Timestamp
- Name
- Company
- Email
- Country
- Message

## File Structure

```
data/
  submissions.json          # All form submissions (JSON)
  submissions-export.csv    # Exported CSV (generated by script)
```

**Note:** `submissions.json` is gitignored to protect user data.

## Resend Free Tier Limits

- **3,000 emails/month** (plenty for a contact form)
- **100 emails/day** rate limit
- HTML email support
- Email tracking (optional)

## Troubleshooting

### Emails Not Sending

1. Check `RESEND_API_KEY` is set correctly
2. Verify the API key is active in Resend dashboard
3. Check server logs for error messages
4. Ensure domain is verified (if using custom domain)

### Submissions Not Saving

1. Check `data/` directory exists and is writable
2. Check server logs for file system errors
3. Ensure the API route has write permissions

### API Route Errors

- Check browser console for client-side errors
- Check server logs for API route errors
- Verify all environment variables are set

## Migration from EmailJS

If you were using EmailJS before:
- Remove `NEXT_PUBLIC_EMAILJS_*` environment variables
- The form now uses `/api/contact` instead of EmailJS
- All submissions are now stored locally in JSON format

## Future Enhancements

When ready to add a database:
- Easy to migrate from JSON to database
- Just update `saveSubmission()` function in `src/app/api/contact/route.ts`
- All data is already structured and ready to import

